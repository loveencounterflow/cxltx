% \linenumbers


\section{Examples}\label{examples}
% \lipsum[1]

\subsection{Spawning NodeJS}\label{spawningnodejs}

(1) The original technique to execute an arbitrary command:
\begin{verbatim}
\immediate\write18{node
  "\CXLTXmainRoute"
  "\currfileabsdir"
  "\jobname"
  "helo"
  "readers (one)"
  > /tmp/temp.dat}\input{/tmp/temp.dat}
\end{verbatim}

(2) With ugly details largely hidden, the \verb#\exec{}# command is still fully general:
\begin{verbatim}
\exec{node
  "\CXLTXmainRoute"
  "\currfileabsdir"
  "\jobname"
  "helo"
  "readers (two)"}
\end{verbatim}

(3) \verb#\nodeRunScript{}# will execute NodeJS code that adheres to the call convention established by
\CXLTX:
\begin{verbatim}
\nodeRunScript
  {\CXLTXmainRoute}
  {\currfileabsdir}
  {\jobname}
  {helo}
  {readers (three)}
\end{verbatim}

(4) Like the previous example, but with standard values assumed as shown above. This is the form that you
will want to use most of the time:
\begin{verbatim}
\nodeRun{helo}{readers (four)}
\end{verbatim}


{\textbf{Outputs:}}

\immediate\write18{node "\CXLTXmainRoute" "\currfileabsdir" "\jobname" "helo" "readers (one)" > /tmp/temp.dat}\input{/tmp/temp.dat}

\exec{node "\CXLTXmainRoute" "\currfileabsdir" "\jobname" "helo" "readers (two)"}

\nodeRunScript{\CXLTXmainRoute}{\currfileabsdir}{\jobname}{helo}{readers (three)}

\nodeRun{helo}{readers (four)}


% ----------------------------------------------------------------------------------------------------------
\subsection{Evaluating Expressions}\label{evalcs}

The commands \verb#\evalcs{}# and \verb#\evaljs{}# allow you to evaluate an arbitrary self-contained
expression, written either in CoffeeScript or in JavaScript:

{\textbf{Command:}}

\begin{verbatim}
$23 + 65 * 123 = \evalcs{23 + 65 * 123}$
\end{verbatim}

{\textbf{Output:}}

$23 + 65 * 123 = \evalcs{23 + 65 * 123}$


% ==========================================================================================================
\subsection{Spawning cURL}\label{spawningcurl}
\begin{verbatim}
\curlRaw{127.0.0.1:8910/foobar.tex/\jobname/helo/friends}
\end{verbatim}
\curlRaw{127.0.0.1:8910/foobar.tex/\jobname/helo/friends}


% ==========================================================================================================
\subsection{Character Escaping}\label{esc}

The \CXLTX\ command \verb#show-special-chrs# demonstrates that it is easy to include \TeX\ special characters
in the return value. The simple rule is that whenever the output of a command is meant to be understood
literally, it should be \verb#@escape#d:

{\textbf{Command:}}

\begin{verbatim}
\nodeRun{show-special-chrs}{}
\end{verbatim}

{\textbf{Output:}}

\nodeRun{show-special-chrs}{}


% ----------------------------------------------------------------------------------------------------------
\subsection{Unicode}\label{unicode}

The next few examples demonstrate that Unicode characters---even ones from outside the Unicode Basic
Multilingual plain, which frequently cause difficulties---can be transported to and from the server
without losses or Mojibake / squiggles:

\begin{verbatim}
\curl{helo}{äöüÄÖÜß}
\end{verbatim}

\curl{helo}{äöüÄÖÜß}

Chinese characters from the Unicode BMP (`16 bit'):

\begin{verbatim}
\curl{helo}{黎永強}
\end{verbatim}

\curl{helo}{黎永強}

Chinese characters from the Unicode SIP (`32 bit'---these needed a little trick to make \XeLaTeX choose
the right font; see \verb#coffeexelatex.sty#):

\begin{verbatim}
\curl{helo}{𠀀𠀐𠀙}
\end{verbatim}

\curl{helo}{𠀀𠀐𠀙}

% % ----------------------------------------------------------------------------------------------------------
% \subsection{The URL environment}\label{urlenv}

% Typing URLs in \LaTeX\ can be quite a chore, given the number of active and otherwise `special' characters
% to take care of: not only does \TeX\ itself define some special characters, not only do the RFCs that govern
% URL syntax consider 〓 〓 〓 〓 〓 〓 〓 〓 〓 〓 〓 〓 〓 〓 〓 〓 〓 〓 〓 special---when we communicate with our \CXLTX\ server,
% we do so by executing a \verb#curl ...# command via the OS shell (normally \verb#sh#), which again has its own
% rich set of specials. In order to alleviate the burden on the casual user, we define a new environment,
% `URL`, that somewhat simplifies writing (parts of) URLs:
% \begin{verbatim}
% \begin{URL}
% \curl{helo}{`\{ [ $ ~ % \# ^ | \} ] '?}
% \end{URL}
% \end{verbatim}
% \begin{URL}
% \curl{helo}{`\{ [ $ ~ % \# ^ | \} ] '?}
% \end{URL}



% \evalcs{ ( n * n for n in [ 1, 2, 3 ] ) }
% % [1,4,9]

% % \evalcs{ '\$' + ( 3 + 4 ) + '\$' }

% \currfileabsdir

% \currfileabspath

% {\fontsize{3mm}{3mm}\nodeRun{show-aux}{}}


% % \begin{verbatim}
% % \begin{URL}
% % \curl{helo}{B \& C % Dollar: $ hash: \# caret: ^ wave:~ backtick: \` }
% % \end{URL}
% % \end{verbatim}
% % \begin{URL}
% % \curl{helo}{B \& C % Dollar: $ hash: \# caret: ^ wave:~ backtick: \` }
% % \end{URL}

% % \usepackage{textcomp} \textquotesingle \textasciigrave


% ==========================================================================================================
\subsection{The \texttt{aux} Object}\label{aux}



% ----------------------------------------------------------------------------------------------------------
\subsubsection{Labels}\label{labels}

\CXLTX\ will try and collect all labels from the \verb#*.aux# file associated with the current job; from
inside your scripts 〓 〓 〓 〓 〓 〓 〓 〓 〓 〓 〓 〓 〓 〓 〓 〓 〓 〓 〓

{\textbf{Command:}}

\begin{verbatim}
\nodeRun{show-aux}{}
\end{verbatim}

{\textbf{Output:}}

{\fontsize{3mm}{3mm}\nodeRun{show-aux}{}}



% ==========================================================================================================
\subsubsection{Geometry}\label{geo}

% Write arbitrary text into the aux file:
\auxc{this line goes to the aux file}

% Write geometry data into the aux file:
\auxgeo

Use geometry data from aux file to render a table of layout dimensions into the document;
note the we could have used the \verb#\auxgeo# command anywhere in the document and that
this currently only works for documents with a single, constant layout.

Also note we're using a dash instead of an underscore here---in \TeX, underscores are special, so
we conveniently allow dashes to make things easier. The \CXLTX\ command \verb#show-geometry# does
not take arguments, which is why the second pair of braces has been left empty:

{\textbf{Command:}}
\begin{verbatim}
\nodeRun{show-geometry}{}
\end{verbatim}

{\textbf{Output:}}

\nodeRun{show-geometry}{}



% % \CXLTXtempErrRoute\ is \CXLTXifFileEmpty{\CXLTXtempErrRoute}{indeed}{not} empty.
% % \CXLTXtempOutRoute\ is \CXLTXifFileEmpty{\CXLTXtempOutRoute}{indeed}{not} empty.

